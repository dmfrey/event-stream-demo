apiVersion: v1
kind: ConfigMap
metadata:
  name: event-stream-demo
data:
  application.yml: |-
    logging.level:
      org.apache.kafka: INFO
      org.springframework.cloud.stream: INFO
      org.springframework.web: INFO
      io.pivotal.dmfrey: DEBUG
    ---
    spring:
      profiles: node
      cloud:
        stream:
          bindings:
            workorder-events-distribution:
              destination: ${node.current}.workorder-events
              group: workorder-events-distribution
              contentType: application/json
              consumer.headerMode: headers
            workorder-events-distribution-cloud:
              destination: ${node.current}.distribution-cloud
              contentType: application/json
    ---
    spring:
      profiles: kubernetes
      cloud:
        stream:
          kafka:
            binder:
              brokers: ["kafka-service.default.svc.cluster.local:9092"]
    logging.level:
      org.apache.kafka: INFO
      org.springframework.cloud.stream: INFO
      org.springframework.security: DEBUG
      org.springframework.web: DEBUG
      io.pivotal.dmfrey: INFO
    ---
    spring:
      profiles: cloud
      cloud:
        stream:
          bindings:
            workorder-events-distribution:
              destination: ${node.current}.workorder-events
              group: workorder-events-distribution
              contentType: application/json
              consumer:
                headerMode: headers
            workorder-events-distribution-local:
              destination: ${node.current}.distribution-local
              contentType: application/json
            workorder-events-distribution-node-17:
              destination: ${node.current}.distribution-node-17
              contentType: application/json
            workorder-events-distribution-node-34:
              destination: ${node.current}.distribution-node-34
              contentType: application/json
    node.current: cloud
    ---
    spring:
      profiles: node-17
    node.current: node-17
    ---
    spring:
      profiles: node-34
    node.current: node-34
